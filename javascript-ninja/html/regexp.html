<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Javascript Ninja</title>
  <style>
    #results li.pass { color: green; }
    #results li.fail { color: red; }
  </style>
</head>

<body>

  <h1>正则表达式 - RegExp</h1>

  <!--<script src="../js/assert/assert.js"></script>-->
  <script src="../js/assert/assert-along.js"></script>
  <!--<script src="../js/assert/assert-async.js"></script>-->

  <!--<script src="object/object.js"></script>-->
  <script src="object/class.js"></script>
  

  <script>

    /**
     * 正则表达式匹配包含的内容
     */
    console.log('test,aaa,test'.match(/tes(t)/));

    /**
     * 使用match匹配
     */
    var html = '<div class="test"><b>hello</b> <i>world!</i></div><h1>title</h1>';
    var regexTag = /<(\/?)(\w+)([^>]*?)>/;
    var regexTagGlobal = /<(\/?)(\w+)([^>]*?)>/g;

    var results = html.match(regexTag);
    var resultsGlobal = html.match(regexTagGlobal);

    console.log('----->局部：', results);
    console.log('----->全局：', resultsGlobal);

    /**
     * 使用exec匹配
     */
    var match, num = 0;
    while ((match = regexTagGlobal.exec(html)) != null) {
      console.log('--->' + num + '：', match);
      num++;
    }

    /**
     * 使用捕获的反向引用
     */
    var regexBack = /<(\w+)([^>]*)>(.*?)<\/\1>/g;
    var numBack = 0;
    while ((match = regexBack.exec(html)) != null) {
      console.log('--->反向引用：' + numBack + '：', match);
      numBack++;
    }

    /**
     * replace
     */
    console.log('fontFamily'.replace(/([A-Z])/g, '-$1').toLowerCase() == 'font-family');
    console.log('fontFamily'.replace(/([A-Z])/g, '-$1').toLowerCase());

    /**
     * 
     */
    function upper(all, letter) {
      console.log(all, letter);
      return letter.toUpperCase();
    }
    console.log('border-bottom-width'.replace(/-(\w)/g, upper));


    /**
     * 用函数进行替换
     */
    var str = 'foo=1&foo=2&blah=a&blah=b&foo=3';
    var regex = /([^=&]+)=([^&]*)/g;
    str.replace(regex, function(all, key, value) {
      console.log('---->all:', all);
      console.log('---->key/value:', key, value);
    });

    /**
     * 转移字符
     */
    var regexEscape = /^((\w+)|\\.)+$/;
    var tests = [
      'formUpdate',
      'from\\.update\\.whatever',
      'form\\:update',
      '\\f\\o\\r\\m\\u\\p\\d\\a\\t\\e',
      'form:update'
    ];
    for (var n = 0; n < tests.length; n++) {
      console.log(tests[n] ,regexEscape.test(tests[n]));
    }

    /**
    * 匹配换行符
    */
    console.log('aaa\nbbb\nccc'.match(/\n/g));

  </script>

</body>
</html>